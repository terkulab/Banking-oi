
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>N26 Local Demo Bank</title>
<style>
/* --- RESET & BASE --- */
*{margin:0;padding:0;box-sizing:border-box;font-family:'Helvetica Neue',Arial,sans-serif}
body{background:#f0f2f5;color:#111;overflow-x:hidden;transition:0.3s}
.hidden{display:none}
.card{background:#fff;padding:25px;margin-bottom:25px;border-radius:20px;box-shadow:0 10px 25px rgba(0,0,0,.08);transition:0.3s}
.card:hover{box-shadow:0 15px 35px rgba(0,0,0,.15)}
button{background:#0052cc;color:#fff;border:none;padding:12px;border-radius:12px;cursor:pointer;width:100%;font-weight:bold;transition:0.3s;font-size:16px}
button:hover{background:#003c99}
input,select,textarea{width:100%;padding:12px;margin:10px 0;border-radius:12px;border:1px solid #ccc;font-size:16px;transition:0.2s}
input:focus, select:focus, textarea:focus{border-color:#0052cc;outline:none}
.sidebar{position:fixed;top:0;left:-260px;width:260px;height:100%;background:#002d72;color:#fff;padding:25px;transition:.4s;z-index:100;overflow-y:auto;}
.sidebar.show{left:0}
.sidebar a{display:flex;align-items:center;color:#fff;padding:15px;margin-bottom:12px;border-radius:15px;text-decoration:none;font-weight:bold;cursor:pointer;transition:0.3s}
.sidebar a:hover{background:rgba(255,255,255,0.1)}
.sidebar a span{margin-left:10px}
.header{background:linear-gradient(90deg,#0052cc,#002d72);color:#fff;padding:18px 25px;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:50;border-bottom-left-radius:20px;border-bottom-right-radius:20px;box-shadow:0 5px 15px rgba(0,0,0,0.1)}
.profile-img{width:120px;height:120px;border-radius:50%;object-fit:cover;margin-bottom:15px;border:4px solid #0052cc;transition:0.3s}
.profile-img:hover{transform:scale(1.05)}
.small{font-size:13px;color:#666}
h2,h3,h4{margin-bottom:12px;font-weight:600}
#overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.3);display:none;z-index:50;transition:0.3s}
table{width:100%;border-collapse:collapse;margin-top:15px;transition:0.3s}
table, th, td{border:1px solid #ccc}
th,td{padding:12px;text-align:center}
th{background:#0052cc;color:#fff}
tr:hover{background:#f1f5f9}
.approved{color:green;font-weight:bold}
.rejected{color:red;font-weight:bold}
.pending{color:orange;font-weight:bold}
@media(max-width:768px){.header{border-radius:0} .sidebar{width:220px}}
</style>
</head>
<body>

<!-- LOGIN PAGE -->
<div id="loginPage">
  <div class="card" style="max-width:380px;margin:120px auto;text-align:center;">
    <h2>üîê Login</h2>
    <input id="loginUser" placeholder="Username">
    <input id="loginPass" type="password" placeholder="Password">
    <button onclick="login()">Login</button>
    <p id="loginMsg" style="color:red;margin-top:10px"></p>
  </div>
</div>

<!-- Overlay -->
<div id="overlay" onclick="toggleSidebar()"></div>

<!-- BANK APP -->
<div id="bankApp" class="hidden">

  <!-- Header -->
  <div id="header" class="header">
    <span onclick="toggleSidebar()" style="cursor:pointer;font-size:22px;">‚ò∞</span>
    <span id="welcomeUser" style="font-weight:bold"></span>
  </div>

  <!-- Sidebar -->
  <div id="sidebar" class="sidebar">
    <h3 style="margin-bottom:20px;">N26 Bank</h3>
    <a onclick="showPage('dashboard')">üè¶ <span>Dashboard</span></a>
    <a onclick="showPage('kyc')">ü™™ <span>KYC</span></a>
    <a onclick="showPage('history')">üìú <span>Transaction History</span></a>
    <a id="adminLink" onclick="adminLoginPrompt()">üõ†Ô∏è <span>Admin Panel</span></a>
    <a onclick="logout()">üö™ <span>Logout</span></a>
  </div>

  <!-- Pages -->
  <div id="pagesContainer">

    <!-- Dashboard -->
    <div id="dashboard" class="page hidden">
      <div class="card" style="text-align:center;">
        <img id="profilePic" src="" class="profile-img" alt="Profile">
        <h3 id="userName"></h3>
        <p>Account #: <span id="accountNumber"></span></p>
        <h2>Balance: $<span id="balance"></span></h2>
      </div>
      <div class="card">
        <h3>Deposit / Withdraw</h3>
        <input id="amt" type="number" placeholder="Amount">
        <select id="txnType"><option value="Deposit">Deposit</option><option value="Withdraw">Withdraw</option></select>
        <button onclick="requestTransaction()">Place Transaction</button>
        <p class="small">Transactions are recorded immediately and withdrawals are pending admin approval.</p>
      </div>
    </div>

    <!-- KYC -->
    <div id="kyc" class="page hidden">
      <div class="card">
        <h3>KYC Verification</h3>
        <input id="kycName" placeholder="Full Name" readonly>
        <input id="kycAccount" placeholder="Account Number" readonly>
        <input id="kycAddress" placeholder="Address" readonly>
        <input type="file" id="kycPhoto" readonly>
        <button id="kycSubmitBtn" onclick="submitKYC()">Submit KYC</button>
      </div>
    </div>

    <!-- Transaction History -->
    <div id="history" class="page hidden">
      <div class="card">
        <h3>Transaction History</h3>
        <div id="txList"></div>
      </div>
    </div>

    <!-- Admin Panel -->
    <div id="admin" class="page hidden">
      <div class="card">
        <h3>Admin Panel - Manage Users</h3>
        <input id="newUser" placeholder="Username">
        <input id="newPass" placeholder="Password">
        <button onclick="createUser()">Create User</button>
        <input id="fundUser" placeholder="Username to Fund">
        <input id="fundAmt" type="number" placeholder="Amount to Add">
        <button onclick="fundUserBalance()">Fund User</button>
      </div>
      <div class="card">
        <h4>All Users & Pending Transactions</h4>
        <table id="adminTable">
          <thead>
            <tr>
              <th>Username</th>
              <th>Password</th>
              <th>Balance</th>
              <th>Transactions</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

  </div>
</div>

<script>
// --- USERS & CURRENT LOGIN ---
let users = JSON.parse(localStorage.getItem("users") || '{}');
if(!users.admin){users.admin={password:"Admin1234!",role:"admin",balance:0,name:"Admin",account:"000001",photo:"",address:"",history:[]};saveUsers();}
let currentUser = localStorage.getItem("currentUser") || null;

// --- LOGIN ---
function login(){
  const u = document.getElementById("loginUser").value.trim();
  const p = document.getElementById("loginPass").value.trim();
  if(users[u] && users[u].password===p){
    currentUser = u;
    localStorage.setItem("currentUser", u);
    document.getElementById("loginPage").style.display="none";
    initBankApp();
  } else {document.getElementById("loginMsg").innerText="Invalid username or password!";}
}

// --- INIT BANK APP ---
function initBankApp(){
  document.getElementById("bankApp").classList.remove("hidden");
  document.getElementById("welcomeUser").innerText=currentUser;
  if(users[currentUser].role!=="admin") document.getElementById("adminLink").style.display="none";
  showPage("dashboard"); updateDashboard(); prepareKYC();
  if(users[currentUser].role==="admin"){setInterval(loadAdminPanel,3000);}
}

// --- SIDEBAR ---
function toggleSidebar(){
  const sb=document.getElementById("sidebar");
  const overlay=document.getElementById("overlay");
  sb.classList.toggle("show");
  overlay.style.display=sb.classList.contains("show")?"block":"none";
}

// --- NAVIGATION ---
function showPage(p){
  document.querySelectorAll(".page").forEach(d=>d.classList.add("hidden"));
  document.getElementById(p).classList.remove("hidden");
  document.getElementById("sidebar").classList.remove("show");
  document.getElementById("overlay").style.display="none";
  if(p==="dashboard") updateDashboard();
  if(p==="history") loadTransactions();
  if(p==="admin") loadAdminPanel();
}

// --- LOGOUT ---
function logout(){localStorage.removeItem("currentUser");location.reload();}

// --- DASHBOARD ---
function updateDashboard(){
  const u = users[currentUser];
  document.getElementById("userName").innerText = u.name||currentUser;
  document.getElementById("accountNumber").innerText = u.account||"N/A";
  document.getElementById("balance").innerText = (u.balance||0).toFixed(2);
  document.getElementById("profilePic").src = u.photo||"https://via.placeholder.com/120";
}

// --- KYC ---
function prepareKYC(){
  const u=users[currentUser];
  const kName=document.getElementById("kycName");
  const kAcc=document.getElementById("kycAccount");
  const kAddr=document.getElementById("kycAddress");
  const kPhoto=document.getElementById("kycPhoto");
  const btn=document.getElementById("kycSubmitBtn");
  if(u.name && u.account && u.photo && u.address){
    kName.value=u.name; kAcc.value=u.account; kAddr.value=u.address; btn.style.display="none"; kPhoto.style.display="none"; kAddr.setAttribute("readonly","readonly");
  } else {
    kName.removeAttribute("readonly"); kAcc.removeAttribute("readonly"); kAddr.removeAttribute("readonly"); kPhoto.removeAttribute("readonly"); btn.style.display="block"; kPhoto.style.display="block";
  }
}
function submitKYC(){
  const name=document.getElementById("kycName").value.trim();
  const account=document.getElementById("kycAccount").value.trim();
  const address=document.getElementById("kycAddress").value.trim();
  const file=document.getElementById("kycPhoto").files[0];
  if(!name||!account||!address){alert("Enter all KYC details"); return;}
  if(file){
    const reader=new FileReader();
    reader.onload=function(e){
      users[currentUser].photo=e.target.result;
      users[currentUser].name=name; users[currentUser].account=account; users[currentUser].address=address;
      saveUsers(); alert("KYC saved successfully!"); prepareKYC(); showPage("dashboard");
    }
    reader.readAsDataURL(file);
  } else {alert("Upload passport photo");}
}

// --- TRANSACTIONS ---
function requestTransaction(){
  const amt=parseFloat(document.getElementById("amt").value);
  const type=document.getElementById("txnType").value;
  if(isNaN(amt)||amt<=0){alert("Enter valid amount"); return;}
  const txObj={user:currentUser,type,amount:amt,status:type==="Deposit"?"approved":"pending",date:new Date().toLocaleString()};
  users[currentUser].history.push({...txObj});
  if(type==="Deposit") users[currentUser].balance+=amt;
  saveUsers(); document.getElementById("amt").value="";
  alert(type==="Deposit"?"Deposit Successful":"Transaction placed and pending admin approval.");
}

// --- LOAD USER HISTORY ---
function loadTransactions(){
  const txs=users[currentUser].history||[];
  document.getElementById("txList").innerHTML=txs.map(t=>{
    let statusClass=t.status==="pending"?"pending":t.status==="approved"?"approved":"rejected";
    return `${t.type}: $${t.amount} <span class="${statusClass}">${t.status==="pending"?"Pending (Contact Support)":t.status==="approved"?"Successful":"Rejected"}</span><br><span class="small">${t.date}</span>`;
  }).join("<hr>");
}

// --- ADMIN LOGIN ---
function adminLoginPrompt(){
  const uname=prompt("Admin Username:");
  const pwd=prompt("Admin Password:");
  if(uname==="admin"&&pwd==="Admin1234!"){users[currentUser].role="admin"; saveUsers(); showPage("admin");} else alert("Wrong admin credentials!");
}

// --- ADMIN FUNCTIONS ---
function createUser(){
  const u=document.getElementById("newUser").value.trim();
  const p=document.getElementById("newPass").value.trim();
  if(!u||!p){alert("Enter username and password"); return;}
  if(users[u]){alert("User exists"); return;}
  users[u]={password:p,role:"user",balance:0,name:"",account:"",photo:"",address:"",history:[]};
  saveUsers(); loadAdminPanel(); alert("User created successfully!");
}
function fundUserBalance(){
  const u=document.getElementById("fundUser").value.trim();
  const amt=parseFloat(document.getElementById("fundAmt").value);
  if(!users[u]||isNaN(amt)||amt<=0){alert("Invalid user or amount"); return;}
  users[u].balance+=amt;
  users[u].history.push({user:u,type:"Deposit",amount:amt,status:"approved",date:new Date().toLocaleString()});
  saveUsers(); loadAdminPanel(); if(currentUser===u) loadTransactions(); alert("User funded successfully!");
}

// --- ADMIN PANEL TABLE ---
function loadAdminPanel(){
  const tbody=document.querySelector("#adminTable tbody"); tbody.innerHTML="";
  Object.keys(users).forEach(u=>{
    if(u==="admin") return;
    const user=users[u];
    const txsHtml=user.history.map((t,i)=>{
      let statusClass=t.status==='pending'?'pending':t.status==='approved'?'approved':'rejected';
      return `${t.type}: $${t.amount} <span class="${statusClass}">${t.status==='pending'?'Pending':t.status==='approved'?'Successful':'Rejected'}</span>`;
    }).join("<br>");
    const actionBtns=user.history.map((t,i)=>{return t.status==="pending"?`<button onclick="adminApprove('${u}',${i})">‚úÖ</button> <button onclick="adminReject('${u}',${i})">‚ùå</button>`:""}).join(" ");
    const tr=document.createElement("tr");
    tr.innerHTML=`<td>${u}</td><td>${user.password}</td><td>${user.balance.toFixed(2)}</td><td>${txsHtml}</td><td>${actionBtns}</td>`;
    tbody.appendChild(tr);
  });
}

// --- ADMIN APPROVE/REJECT ---
function adminApprove(user,idx){
  const t=users[user].history[idx];
  if(t.type==="Withdraw" && users[user].balance<t.amount){alert("Insufficient balance"); return;}
  if(t.type==="Withdraw") users[user].balance-=t.amount; else users[user].balance+=t.amount;
  t.status="approved"; saveUsers(); loadAdminPanel(); if(currentUser===user) loadTransactions(); updateDashboard();
}
function adminReject(user,idx){users[user].history[idx].status="rejected"; saveUsers(); loadAdminPanel(); if(currentUser===user) loadTransactions(); updateDashboard();}

// --- SAVE USERS ---
function saveUsers(){localStorage.setItem("users",JSON.stringify(users)); updateDashboard();}

// --- AUTO LOGIN ---
if(currentUser){document.getElementById("loginPage").style.display="none"; initBankApp();}
</script>
</body>
</html>
